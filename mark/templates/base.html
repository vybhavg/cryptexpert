<!DOCTYPE html>
<html lang="en">
    
<!--Designed By ALpha-->
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>{% block title %}{% endblock %}
        </title>
<link rel="icon" type="image/png" href="/static/img/favicon.ico">
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@8/swiper-bundle.min.css">
<!-- Bootstrap CSS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- Emoji Button CDN -->

<!-- Bootstrap Icons (optional) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
<!-- Add this to the <head> section -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@11/dist/sweetalert2.min.css">

<!-- Add this before the closing </body> tag -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fugaz+One&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Audiowide&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Sriracha&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@100;300;400;700;900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter+Tight:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Vendor Styles -->
    <link rel="stylesheet" href="/static/vendors/bower_components/material-design-iconic-font/dist/css/material-design-iconic-font.min.css">
    <link rel="stylesheet" href="/static/vendors/bower_components/animate.css/animate.min.css">
    <link rel="stylesheet" href="/static/vendors/bower_components/jquery.scrollbar/jquery.scrollbar.css">
    <link rel="stylesheet" href="/static/vendors/bower_components/fullcalendar/dist/fullcalendar.min.css">

    <!-- TailwindCSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- App Styles -->
    <link rel="stylesheet" href="/static/css/app.min.css">

    {% block head %}    {% endblock %}

    <style>
        .crypto {
            font-weight: bold;
            color: white;
        }
        .expert {
            font-weight: bold;
            color: #f8bc04; /* Gold color */
        }
        .welcome-text2 {
                font-family: "Audiowide", serif;
                font-weight: 400;
  font-style: normal;
            font-size: 25px;
            color: white;
            text-align: center;
        }
        :root {
    --black: #000;
    --dirty-white: #d0d0d0;
    --yellow: #f8bc04;
    --white-5: #ffffff0d;
    --yellow-10: #fff6001a;
    --white-40: #d0d0d066;
    --white-60: #d0d0d099;
    --yellow-40: #fff60080;
    --white-20: #d0d0d033;
    --black-gray: #0d0d0d;
}

body {
    overflow-x: hidden; /* Prevent horizontal scrollbar */
}

html {
    scroll-behavior: smooth;
}header.b {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    height: 100vh; /* Full viewport height */
    color: white;
    text-align: center;
    overflow: hidden;
}

.video-background {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover; /* Ensures the video covers the entire header */
    z-index: -1; /* Places the video behind the text */
    filter: blur(0px);
}

.welcome-text2 {
    font-family: "Audiowide", serif;
    font-weight: 400;
    font-style: normal;
    font-size: 25px;
    color: white;
    text-align: center;
}

.welcome-text {
    font-family: "Audiowide", serif;
    font-weight: 400;
    font-style: normal;
    font-size: 32px;
    color: white;
    text-align: center;
}

.sidetext {
    font-family: "Sriracha", serif;
    font-weight: 400;
    font-style: normal;
    font-size: 20px;
    color: #f8bc04;
    text-align: center;
}

.crypto {
    font-weight: bold;
    color: white;
}

.expert {
    font-weight: bold;
    color: #f8bc04; /* Gold color */
}  


/* Enhanced Search Results */
#searchResults {
    position: absolute;
    top: calc(100% + 5px);
    left: 0;
    right: 0;
    background: rgba(15, 15, 15, 0.98);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border-radius: 12px;
    border: 1px solid rgba(248, 188, 4, 0.2);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.5);
    max-height: 500px;
    overflow-y: auto;
    z-index: 1000;
    display: none;
    padding: 10px 0;
    opacity: 0;
    transform: translateY(10px);
    transition: opacity 0.3s ease, transform 0.3s ease;
}

#searchResults.show {
    opacity: 1;
    transform: translateY(0);
}

.search-result-item {
    display: flex;
    align-items: center;
    padding: 12px 20px;
    color: white;
    cursor: pointer;
    transition: all 0.2s ease;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.search-result-item:last-child {
    border-bottom: none;
}

.search-result-item:hover {
    background: rgba(248, 188, 4, 0.08);
}

.search-result-item.highlighted {
    background: rgba(248, 188, 4, 0.15);
}

.search-result-item .crypto-logo {
    width: 32px;
    height: 32px;
    margin-right: 15px;
    border-radius: 50%;
    object-fit: cover;
    border: 1px solid rgba(248, 188, 4, 0.3);
}

.search-result-item .result-content {
    flex: 1;
}

.search-result-item .result-name {
    font-weight: 500;
    margin-bottom: 4px;
    font-size: 0.95rem;
    display: flex;
    align-items: center;
}

.search-result-item .result-symbol {
    color: #f8bc04;
    font-size: 0.85rem;
    margin-left: 8px;
    font-weight: 400;
}

.search-result-item .result-type {
    font-size: 0.8rem;
    color: rgba(255, 255, 255, 0.6);
    display: flex;
    align-items: center;
}

.search-result-item .result-type i {
    margin-right: 5px;
    font-size: 0.9rem;
}

.search-result-item .result-price {
    font-weight: 600;
    font-size: 0.9rem;
    text-align: right;
    margin-left: 15px;
}

.search-result-item .price-up {
    color: #4CAF50;
}

.search-result-item .price-down {
    color: #F44336;
}

.search-result-item .price-neutral {
    color: rgba(255, 255, 255, 0.7);
}

.no-results {
    padding: 20px;
    color: rgba(255, 255, 255, 0.7);
    text-align: center;
    font-size: 0.9rem;
}

.no-results i {
    font-size: 1.5rem;
    margin-bottom: 10px;
    display: block;
    color: rgba(255, 255, 255, 0.3);
}

/* Popular searches section */
.popular-searches {
    padding: 15px 20px;
    border-top: 1px solid rgba(255, 255, 255, 0.05);
}

.popular-searches h4 {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.85rem;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.popular-tags {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.popular-tag {
    background: rgba(248, 188, 4, 0.1);
    color: rgba(248, 188, 4, 0.9);
    padding: 5px 12px;
    border-radius: 20px;
    font-size: 0.8rem;
    cursor: pointer;
    transition: all 0.2s ease;
    border: 1px solid rgba(248, 188, 4, 0.2);
}

.popular-tag:hover {
    background: rgba(248, 188, 4, 0.2);
    color: #f8bc04;
}

/* Recent searches section */
.recent-searches {
    padding: 15px 20px;
}

.recent-searches h4 {
    color: rgba(255, 255, 255, 0.7);
    font-size: 0.85rem;
    margin-bottom: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}

.recent-search-item {
    display: flex;
    align-items: center;
    padding: 8px 0;
    color: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all 0.2s ease;
}

.recent-search-item:hover {
    color: #f8bc04;
}

.recent-search-item i {
    margin-right: 10px;
    font-size: 1rem;
    color: rgba(255, 255, 255, 0.5);
}

/* Custom scrollbar */
#searchResults::-webkit-scrollbar {
    width: 6px;
}

#searchResults::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 3px;
}

#searchResults::-webkit-scrollbar-thumb {
    background: rgba(248, 188, 4, 0.5);
    border-radius: 3px;
}

#searchResults::-webkit-scrollbar-thumb:hover {
    background: rgba(248, 188, 4, 0.7);
}

/* Loading animation */
.search-loading {
    padding: 20px;
    text-align: center;
}

.search-loading .spinner {
    width: 30px;
    height: 30px;
    border: 3px solid rgba(248, 188, 4, 0.2);
    border-top-color: #f8bc04;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 0 auto 10px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Container with Black Background */
.container.mx-auto.p-8.bg-gray-900 {
    background-color: #000 !important; /* Black background */
    padding: 2rem;
    color: #fff; /* White text */
}


.grid.grid-cols-1.md\:grid-cols-4.gap-8 {
    display: grid;
    grid-template-columns: repeat(1, 1fr);
    gap: 2rem;
}

@media (min-width: 768px) {
    .grid.grid-cols-1.md\:grid-cols-4.gap-8 {
        grid-template-columns: repeat(4, 1fr);
    }
}

.text-\[\#f8bc04\] {
    color: #f8bc04;
}

.text-gray-400 {
    color: #9ca3af;
}

.hover\:text-\[\#f8bc04\]:hover {
    color: #f8bc04;
}
        
.swal2-dark {
    background-color: #1a1a1a; /* Dark background */
    color: #ffffff; /* White text */
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
}

/* Ensure the toast applies the dark mode styles correctly */
.swal2-toast.swal2-dark {
    background-color: #1a1a1a; /* Ensure toast inherits dark background */
    color: #ffffff; /* White text */
}

.swal2-toast.swal2-dark .swal2-title {
    color: #ffffff; /* White title text */
}

.swal2-toast.swal2-dark .swal2-html-container {
    color: #cccccc; /* Light gray content text */
}

.swal2-toast.swal2-dark .swal2-icon {
    color: #f8bc04; /* Yellow icon */
}

/* Ensure the timer progress bar is styled correctly */
.swal2-toast.swal2-dark .swal2-timer-progress-bar {
    background: #f8bc04 !important; /* Yellow progress bar */
}
        
.slide-in-right {
    animation: slideInRight 1s ease-out forwards;
}

.slide-in-left {
    animation: slideInLeft 1s ease-out forwards;
}

@keyframes slideInRight {
    0% {
        transform: translateX(100%);
        opacity: 0;
    }
    100% {
        transform: translateX(0);
        opacity: 1;
    }
}

@keyframes slideInLeft {
    0% {
        transform: translateX(-100%);
        opacity: 0;
    }
    100% {
        transform: translateX(0);
        opacity: 1;
    }
}
      /* Notification Dropdown Container */
.dropdown-menu--block2 {
    background: linear-gradient(135deg, #1a1a1a, #222) !important;
    border: 1px solid rgba(248, 188, 4, 0.15) !important;
    border-radius: 12px !important;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.5) !important;
    width: 380px;
    padding: 0;
    overflow: hidden;
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    transform-origin: top right;
}



/* Dropdown Header */
.dropdown-header {
    padding: 16px 20px;
    color: white !important;
    font-weight: 600;
    font-size: 1.1rem;
    font-family: 'Inter', sans-serif;
    border-bottom: 1px solid rgba(248, 188, 4, 0.1);
    background: rgba(15, 15, 15, 0.9);
    display: flex;
    justify-content: space-between;
    align-items: center;
    position: sticky;
    top: 0;
    z-index: 1;
}

/* Action Buttons */
.actions__item {
    color: rgba(255, 255, 255, 0.6) !important;
    transition: all 0.2s ease;
    font-size: 1.2rem;
    padding: 4px;
    border-radius: 4px;
}

.actions__item:hover {
    color: #F8BC04 !important;
    transform: scale(1.1);
    background: rgba(248, 188, 4, 0.1);
}

/* Notification List Container */
.listview {
    max-height: 400px;
    overflow-y: auto;
    scrollbar-width: thin;
    scrollbar-color: #F8BC04 rgba(255, 255, 255, 0.05);
}

/* Notification Items */
.listview__item {
    padding: 16px 20px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    display: flex;
    align-items: flex-start;
    gap: 12px;
    position: relative;
}

.listview__item:last-child {
    border-bottom: none;
}

.listview__item:hover {
    background: rgba(248, 188, 4, 0.08) !important;
    transform: translateX(2px);
}

.listview__item.unread {
    background: linear-gradient(90deg, rgba(248, 188, 4, 0.08), transparent);
    border-left: 3px solid #F8BC04;
}

/* Notification Content */
.listview__content {
    flex: 1;
}

.listview__heading {
    color: white !important;
    font-weight: 500;
    font-size: 0.95rem;
    line-height: 1.4;
    margin-bottom: 4px;
    display: flex;
    justify-content: space-between;
}

.listview__heading .notification-text {
    flex: 1;
}

.notification-text .mention {
    color: #fff;
    font-weight: 500;
}

.notification-text .action {
    color: #4CAF50;
    font-weight: 500;
}

.listview__heading small {
    color: rgba(255, 255, 255, 0.5) !important;
    font-size: 0.75rem;
    font-weight: 400;
    margin-left: 8px;
    white-space: nowrap;
}

.listview__content small {
    color: rgba(255, 255, 255, 0.6) !important;
    font-size: 0.8rem;
    display: block;
}

/* View More Link */
.view-more {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 14px;
    color: #F8BC04 !important;
    font-weight: 500;
    text-align: center;
    border-top: 1px solid rgba(248, 188, 4, 0.1);
    transition: all 0.3s ease;
    background: rgba(15, 15, 15, 0.8);
    position: sticky;
    bottom: 0;
}

.view-more:hover {
    background: rgba(248, 188, 4, 0.15) !important;
    text-decoration: none;
    letter-spacing: 0.5px;
}

.view-more i {
    font-size: 18px;
    transition: transform 0.3s ease;
}

.view-more:hover i {
    transform: translateX(2px);
}

/* Custom scrollbar */
.listview::-webkit-scrollbar {
    width: 6px;
}

.listview::-webkit-scrollbar-track {
    background: rgba(255, 255, 255, 0.05);
    border-radius: 3px;
}

.listview::-webkit-scrollbar-thumb {
    background: #F8BC04;
    border-radius: 3px;
    transition: background 0.3s;
}

.listview::-webkit-scrollbar-thumb:hover {
    background: #e6a905;
}

/* Badge styling */
.badge-pill {
    background-color: #F8BC04 !important;
    color: #1a1a1a !important;
    font-weight: 600;
    position: absolute;
    top: -6px;
    right: -6px;
    font-size: 0.7rem;
    min-width: 18px;
    height: 18px;
    line-height: 18px;
    padding: 0 5px;
    border: 2px solid #1a1a1a;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

/* Notification icon */
.top-nav__notify {
    position: relative;
    color: rgba(255, 255, 255, 0.8);
    transition: all 0.3s ease;
    font-size: 1.3rem;
}

.top-nav__notify:hover {
    color: #F8BC04 !important;
    transform: scale(1.1);
}

/* Animations */
@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.15); }
    100% { transform: scale(1); }
}

.has-notifications {
    animation: pulse 1.5s infinite;
}

/* Unread indicator dot */
.unread-dot {
    position: absolute;
    right: 16px;
    top: 50%;
    transform: translateY(-50%);
    width: 8px;
    height: 8px;
    background: #F8BC04;
    border-radius: 50%;
    box-shadow: 0 0 0 2px rgba(248, 188, 4, 0.3);
}

/* Empty state */
.empty-notification {
    padding: 30px 20px;
    text-align: center;
    color: rgba(255, 255, 255, 0.5);
}

.empty-notification i {
    font-size: 2.5rem;
    color: rgba(255, 255, 255, 0.2);
    margin-bottom: 12px;
    display: block;
}

.empty-notification p {
    margin: 0;
    font-size: 0.9rem;
}
        {% block style %}{% endblock %}
    </style>
</head>

    <body style="background-color:black;">
        <main class="main">
            <div class="page-loader">
                <div class="page-loader__spinner">
                    <svg viewBox="25 25 50 50">
                        <circle cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10" />
                    </svg>
                </div>
            </div>

            <header class="header">
                <div class="navigation-trigger" data-sa-action="aside-open" data-sa-target=".sidebar">
                    <i class="zmdi zmdi-menu"></i>
                </div>

                <div class="logo hidden-sm-down">
                    <a href="{{url_for('index')}}" class="welcome-text2">
                        <span class="crypto">Crypt</span><span class="expert">Expert</span>                    
                    </a>
                </div>

 <!-- Search Form -->
<form class="search" onsubmit="return false;">
    <div class="search__inner">
        <input type="text" id="searchInput" class="search__text" 
               placeholder="Search for crypto, exchanges, wallets..."
               onkeyup="performSearch()"
               onfocus="performSearch()">
        <i class="zmdi zmdi-search search__helper" onclick="performSearch()"></i>
    </div>
    <!-- Search Results -->
    <div id="searchResults"></div>
</form>

<script>
    let currentIndex = -1;
    let searchTimeout;
    let lastSearchQuery = '';

    async function performSearch() {
        const query = document.getElementById('searchInput').value.trim();
        const resultsDiv = document.getElementById('searchResults');
        
        // Clear previous timeout if it exists
        if (searchTimeout) {
            clearTimeout(searchTimeout);
        }

        // Show loading state if query is not empty
        if (query.length > 0) {
            resultsDiv.innerHTML = `
                <div class="search-loading">
                    <div class="spinner"></div>
                    <div>Searching...</div>
                </div>
            `;
            resultsDiv.style.display = 'block';
            resultsDiv.classList.add("show");
            
            // Store the current query
            lastSearchQuery = query;
            
            // Add slight delay to prevent too many requests
            searchTimeout = setTimeout(async () => {
                try {
                    const response = await fetch(`/search?q=${encodeURIComponent(query)}`);
                    const results = await response.json();
                    
                    // Only update if the query hasn't changed during the request
                    if (query === lastSearchQuery) {
                        displaySearchResults(results, query);
                    }
                } catch (error) {
                    console.error("Error fetching search results:", error);
                    if (query === lastSearchQuery) {
                        resultsDiv.innerHTML = `
                            <div class="no-results">
                                <i class="zmdi zmdi-alert-circle"></i>
                                <div>Failed to load results. Please try again.</div>
                            </div>
                        `;
                    }
                }
            }, 300);
        } else {
            // Show recent/popular searches when empty
            showDefaultSuggestions();
        }
    }

    function displaySearchResults(results, query) {
        const resultsDiv = document.getElementById('searchResults');
        
        if (results.length > 0) {
            resultsDiv.innerHTML = results.map((item) => {
                // Highlight matching parts of the query
                const regex = new RegExp(`(${query})`, "gi");
                const highlightedName = item.name.replace(regex, `<span style="color: #f8bc04; font-weight: bold;">$1</span>`);
                
                // Determine price change class
                let priceClass = 'price-neutral';
                if (item.price_change) {
                    priceClass = item.price_change > 0 ? 'price-up' : 'price-down';
                }
                
                return `
                    <div class="search-result-item" onclick="window.location.href='${item.link}'">
                        <img src="${item.image || '/static/img/default-crypto.png'}" alt="${item.name}" class="crypto-logo">
                        <div class="result-content">
                            <div class="result-name">
                                ${highlightedName}
                                ${item.symbol ? `<span class="result-symbol">${item.symbol}</span>` : ''}
                            </div>
                            <div class="result-type">
                                <i class="zmdi ${getIconForType(item.type)}"></i>
                                ${item.type}
                            </div>
                        </div>
                        ${item.price ? `
                            <div class="result-price ${priceClass}">
                                $${item.price.toLocaleString()}
                                ${item.price_change ? `
                                    <br>
                                    <small>${item.price_change > 0 ? '+' : ''}${item.price_change}%</small>
                                ` : ''}
                            </div>
                        ` : ''}
                    </div>
                `;
            }).join('');
            
            // Add popular searches section at the bottom
            resultsDiv.innerHTML += `
                <div class="popular-searches">
                    <h4>Popular Searches</h4>
                    <div class="popular-tags">
                        <div class="popular-tag" onclick="searchFor('Bitcoin')">Bitcoin</div>
                        <div class="popular-tag" onclick="searchFor('Ethereum')">Ethereum</div>
                        <div class="popular-tag" onclick="searchFor('Binance')">Binance</div>
                        <div class="popular-tag" onclick="searchFor('NFT')">NFT</div>
                        <div class="popular-tag" onclick="searchFor('DeFi')">DeFi</div>
                    </div>
                </div>
            `;
        } else {
            resultsDiv.innerHTML = `
                <div class="no-results">
                    <i class="zmdi zmdi-search"></i>
                    <div>No results found for "${query}"</div>
                    <div class="popular-searches" style="margin-top: 15px; border-top: none;">
                        <h4>Try searching for:</h4>
                        <div class="popular-tags">
                            <div class="popular-tag" onclick="searchFor('Bitcoin')">Bitcoin</div>
                            <div class="popular-tag" onclick="searchFor('Ethereum')">Ethereum</div>
                            <div class="popular-tag" onclick="searchFor('Binance')">Binance</div>
                        </div>
                    </div>
                </div>
            `;
        }
        
        resultsDiv.style.display = 'block';
        resultsDiv.classList.add("show");
    }

    function showDefaultSuggestions() {
        const resultsDiv = document.getElementById('searchResults');
        
        resultsDiv.innerHTML = `
            <div class="recent-searches">
                <h4>Recent Searches</h4>
                <div class="recent-search-item" onclick="searchFor('Bitcoin')">
                    <i class="zmdi zmdi-time"></i>
                    <span>Bitcoin</span>
                </div>
                <div class="recent-search-item" onclick="searchFor('Ethereum')">
                    <i class="zmdi zmdi-time"></i>
                    <span>Ethereum</span>
                </div>
                <div class="recent-search-item" onclick="searchFor('Solana')">
                    <i class="zmdi zmdi-time"></i>
                    <span>Solana</span>
                </div>
            </div>
            <div class="popular-searches">
                <h4>Popular Searches</h4>
                <div class="popular-tags">
                    <div class="popular-tag" onclick="searchFor('Bitcoin')">Bitcoin</div>
                    <div class="popular-tag" onclick="searchFor('Ethereum')">Ethereum</div>
                    <div class="popular-tag" onclick="searchFor('Binance')">Binance</div>
                    <div class="popular-tag" onclick="searchFor('NFT')">NFT</div>
                    <div class="popular-tag" onclick="searchFor('DeFi')">DeFi</div>
                    <div class="popular-tag" onclick="searchFor('Metaverse')">Metaverse</div>
                    <div class="popular-tag" onclick="searchFor('Web3')">Web3</div>
                    <div class="popular-tag" onclick="searchFor('Stablecoins')">Stablecoins</div>
                </div>
            </div>
        `;
        
        resultsDiv.style.display = 'block';
        resultsDiv.classList.add("show");
    }

    function getIconForType(type) {
        const icons = {
            'crypto': 'zmdi-money',
            'exchange': 'zmdi-balance',
            'wallet': 'zmdi-wallet',
            'nft': 'zmdi-collection-image',
            'defi': 'zmdi-shape',
            'token': 'zmdi-label',
            'coin': 'zmdi-money-box'
        };
        return icons[type.toLowerCase()] || 'zmdi-search';
    }

    function searchFor(term) {
        document.getElementById('searchInput').value = term;
        performSearch();
    }

    // Navigate to selected result on Enter key press
    document.addEventListener('keydown', function (event) {
        const resultsDiv = document.getElementById('searchResults');
        if (!resultsDiv.style.display || resultsDiv.style.display === 'none') return;
        
        const results = resultsDiv.querySelectorAll('.search-result-item');
        
        if (event.key === 'ArrowDown') {
            event.preventDefault();
            if (currentIndex < results.length - 1) {
                currentIndex++;
            }
            updateHighlight(results);
        } else if (event.key === 'ArrowUp') {
            event.preventDefault();
            if (currentIndex > 0) {
                currentIndex--;
            }
            updateHighlight(results);
        } else if (event.key === 'Enter' && currentIndex >= 0 && currentIndex < results.length) {
            // Redirect to the selected link on Enter
            window.location.href = results[currentIndex].getAttribute('onclick').replace("window.location.href='", "").replace("'", "");
        }
    });

    function updateHighlight(results) {
        // Remove highlight from all results
        for (let i = 0; i < results.length; i++) {
            results[i].classList.remove('highlighted');
        }

        // Highlight the current index
        if (currentIndex >= 0 && currentIndex < results.length) {
            results[currentIndex].classList.add('highlighted');
            results[currentIndex].scrollIntoView({
                behavior: 'smooth',
                block: 'nearest'
            });
        }
    }

    // Hide search results when clicking outside
    document.addEventListener("click", function(event) {
        const searchBox = document.querySelector(".search");
        const resultsDiv = document.getElementById("searchResults");

        if (!searchBox.contains(event.target)) {
            resultsDiv.style.display = 'none';
            resultsDiv.classList.remove("show");
            currentIndex = -1;
        }
    });

    // Initialize with popular searches when input is focused and empty
    document.getElementById('searchInput').addEventListener('focus', function() {
        if (this.value.trim() === '') {
            showDefaultSuggestions();
        }
    });
</script>

                <ul class="top-nav">
                    <li class="hidden-xl-up"><a href="#" data-sa-action="search-open"><i class="zmdi zmdi-search"></i></a></li>

                   

                    <li class="dropdown top-nav__notifications" style="margin-bottom:-7px;">
                        <a href="#" data-toggle="dropdown" class="top-nav__notify">
                            <i class="zmdi zmdi-notifications"></i>
                        </a>
                       <div class="dropdown-menu dropdown-menu-right dropdown-menu--block2">
    <div class="dropdown-header">
        Notifications
        <div class="actions">
            <a href="#" class="actions__item zmdi zmdi-check-all" data-sa-action="notifications-clear"></a>
        </div>
    </div>

    <div class="listview listview--hover">
        <div class="listview__scroll scrollbar-inner" id="notification-container">
            <!-- Notifications will be loaded here via JavaScript -->
            <div class="text-center py-3">
                <div class="spinner-border text-primary" role="status">
                    <span class="sr-only">Loading...</span>
                </div>
            </div>
        </div>
    </div>
</div>

                                <div class="p-1"></div>
                            </div>
                        </div>
                    </li>

                   

                    <li class="dropdown hidden-xs-down">
                        <a href="#" data-toggle="dropdown"><i class="zmdi zmdi-apps"></i></a>

                        <div class="dropdown-menu dropdown-menu-right dropdown-menu--block2" role="menu">
                            <div class="row app-shortcuts">
                                <a class="col-4 app-shortcuts__item" href="#">
                                    <i class="zmdi zmdi-calendar"></i>
                                    <small class="">Calendar</small>
                                </a>
                                <a class="col-4 app-shortcuts__item" href="#">
                                    <i class="zmdi zmdi-file-text"></i>
                                    <small class="">Files</small>
                                </a>
                                <a class="col-4 app-shortcuts__item" href="#">
                                    <i class="zmdi zmdi-email"></i>
                                    <small class="">Email</small>
                                </a>
                                <a class="col-4 app-shortcuts__item" href="#">
                                    <i class="zmdi zmdi-trending-up"></i>
                                    <small class="">Reports</small>
                                </a>
                                <a class="col-4 app-shortcuts__item" href="#">
                                    <i class="zmdi zmdi-view-headline"></i>
                                    <small class="">News</small>
                                </a>
                                <a class="col-4 app-shortcuts__item" href="#">
                                    <i class="zmdi zmdi-image"></i>
                                    <small class="">Gallery</small>
                                </a>
                            </div>
                        </div>
                    </li>

                    <li class="dropdown hidden-xs-down">
                        <a href="#" data-toggle="dropdown"><i class="zmdi zmdi-more-vert"></i></a>

                        <div class="dropdown-menu dropdown-menu-right">
                            <div class="dropdown-item theme-switch">
                                Theme Switch

                                <div class="btn-group btn-group--colors mt-2 d-block" data-toggle="buttons">
                                    <label class="btn active border-0" style="background-color: #772036; color: goldenrod;"><input type="radio" value="1" autocomplete="off" checked></label>
                                    <label class="btn border-0" style="background-color: #273C5B; color: goldenrod;"><input type="radio" value="2" autocomplete="off"></label>
                                    <label class="btn border-0" style="background-color: #174042; color: goldenrod;"><input type="radio" value="3" autocomplete="off"></label>
                                    <label class="btn border-0" style="background-color: #fff; color: goldenrod; "><input type="radio" value="4" autocomplete="off"></label>
                                    <label class="btn border-0" style="background-color: #49423F; color: goldenrod;"><input type="radio" value="5" autocomplete="off"></label>

                                    <br>

                                    <label class="btn border-0" style="background-color: #5e3d22; color: goldenrod;"><input type="radio" value="6" autocomplete="off"></label>
                                    <label class="btn border-0" style="background-color: #234d6d; color: goldenrod;"><input type="radio" value="7" autocomplete="off"></label>
                                    <label class="btn border-0" style="background-color: #3b5e5e; color: goldenrod;"><input type="radio" value="8" autocomplete="off"></label>
                                    <label class="btn border-0" style="background-color: #0a4c3e; color: goldenrod;"><input type="radio" value="9" autocomplete="off"></label>
                                    <label class="btn border-0" style="background-color: #7b3d54; color: goldenrod;"><input type="radio" value="10" autocomplete="off"></label>
                                </div>
                            </div>
                            <a href="#" class="dropdown-item" data-sa-action="fullscreen">Fullscreen</a>
                            <a href="#" class="dropdown-item">Clear Local Storage</a>
                        </div>
                    </li>

                    <li class="dropdown hidden-xs-down">
    <a href="#" data-toggle="dropdown">
        <img class="user__img" src="static/demo/img/profile-pics/8.jpg" style="margin-left: 8px;" alt="">
    </a>
    <div class="dropdown-menu dropdown-menu-right dropdown-menu--block" role="menu">
        <div class="row app-shortcuts">
            {% if current_user.is_authenticated %}
                <!-- Show these options if the user is logged in -->
                <a class="col-4 app-shortcuts__item" href="{{url_for('profile')}}">
                    <i class="zmdi zmdi-account-circle"></i>
                    <small>View Profile</small>
                </a>
                <a class="col-4 app-shortcuts__item" href="#">
                    <i class="zmdi zmdi-settings"></i>
                    <small>Settings</small>
                </a>
                <a class="col-4 app-shortcuts__item" href="{{ url_for('logout_page') }}">
                    <i class="zmdi zmdi-power"></i>
                    <small>Log Out</small>
                </a>
            {% else %}
                <!-- Show these options if the user is not logged in -->
                <a class="col-6 app-shortcuts__item" href="{{ url_for('login_form') }}">
                    <i class="zmdi zmdi-account"></i>
                    <small>Log In</small>
                </a>
                <a class="col-6 app-shortcuts__item" href="{{ url_for('register_form') }}">
                    <i class="zmdi zmdi-account-add"></i>
                    <small>Register</small>
                </a>
            {% endif %}
        </div>
    </div>
</li>
                </ul>

                <div class="clock hidden-md-down">
                    <div class="time">
                        <span class="hours"></span>
                        <span class="min"></span>
                        <span class="sec"></span>
                    </div>
                </div>

                
                
            </header>

            <aside class="sidebar">
                <div class="scrollbar-inner">

   <div class="user">
    <div class="user__info" data-toggle="dropdown">
        <img class="user__img" src="static/demo/img/profile-pics/8.jpg" alt="">
        <div>
            {% if current_user.is_authenticated %}
                <!-- Show name and email if the user is logged in -->
                <div class="user__name">{{ current_user.username }}</div>
                <div class="user__email">{{ current_user.email }}</div>
            {% else %}
                <!-- Show placeholder text if the user is not logged in -->
                <div class="user__name">Guest</div>
                <div class="user__email">Not logged in</div>
            {% endif %}
        </div>
    </div>

    <div class="dropdown-menu">
        {% if current_user.is_authenticated %}
            <!-- Show these options if the user is logged in -->
            <a class="dropdown-item" href="{{url_for('profile')}}">View Profile</a>
            <a class="dropdown-item" href="#">Settings</a>
            <a class="dropdown-item" href="{{ url_for('logout_page') }}">Logout</a>
        {% else %}
            <!-- Show these options if the user is not logged in -->
            <a class="dropdown-item" href="{{ url_for('login_form') }}">Log In</a>
            <a class="dropdown-item" href="{{ url_for('register_form') }}">Register</a>
        {% endif %}
    </div>
</div>

                   <ul class="navigation">
    <li class="{% if request.endpoint in ['index', 'home'] %}navigation__active{% endif %}">
        {% if current_user.is_authenticated %}
            <a href="{{ url_for('index') }}"><i class="zmdi zmdi-home"></i> Home</a>
        {% else %}
            <a href="{{ url_for('home') }}"><i class="zmdi zmdi-home"></i> Home</a>
        {% endif %}
    </li>
    
    <li class="{% if request.endpoint == 'wallet_management' %}navigation__active{% endif %}">
        <a href="{{url_for('wallet_management')}}"><i class="zmdi zmdi-view-week"></i> Wallets</a>
    </li>
    
    <li class="{% if request.path.startswith('/charts') %}navigation__active{% endif %}">
        <a href="/charts?symbol=BTCUSDT"><i class="zmdi zmdi-library"></i> Live Charts</a>
    </li>

    <li class="{% if request.endpoint == 'live_prices' %}navigation__active{% endif %}">
        <a href="{{url_for('live_prices')}}"><i class="zmdi zmdi-format-underlined"></i> Live Prices</a>
    </li>

    <li class="{% if request.endpoint == 'ai_predictor' %}navigation__active{% endif %}">
        <a href="{{url_for('ai_predictor')}}"><i class="zmdi zmdi-widgets"></i> Price Predictor AI</a>
    </li>
    <li><a href="{{ url_for('blog_home') }}" class="text-gray-400 hover:text-white">Blog</a></li>
{% if current_user.is_admin %}
<li><a href="{{ url_for('create_blog_post') }}" class="text-gray-400 hover:text-white">Create Post</a></li>
{% endif %}
    <li class="{% if request.endpoint == 'forum_home' %}navigation__active{% endif %}">
        <a href="{{ url_for('forum_home') }}"><i class="zmdi zmdi-comment-more"></i> Discussion Forums</a>
    </li>
</ul>
                </div>
            </aside>
          
 <script>
     const iconMap = {
    success: 'success',
    error: 'error',
    warning: 'warning',
    info: 'info',
};
        // Get flashed messages from Flask
        const flashedMessages = [
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        {
                            category: "{{ category }}",
                            message: "{{ message }}"
                        },
                    {% endfor %}
                {% endif %}
            {% endwith %}
        ];

        // Loop through flashed messages and display them using SweetAlert2
        flashedMessages.forEach((msg) => {
            Swal.fire({
    icon: iconMap[msg.category] || 'info', // Default to 'info' if category is not mapped
    title: msg.category.toUpperCase(),
    text: msg.message,
    toast: true,
    position: 'top-end',
    showConfirmButton: false,
    timer: 3000,
    timerProgressBar: true,
    customClass: {
        popup: 'swal2-dark', // Apply dark mode styles
    },
});
        });
    </script>


{% block content %}
            
{% endblock %}

        <!-- Older IE warning message -->
            <!--[if IE]>
                <div class="ie-warning">
                    <h1>Warning!!</h1>
                    <p>You are using an outdated version of Internet Explorer, please upgrade to any of the following web browsers to access this website.</p>

                    <div class="ie-warning__downloads">
                        <a href="http://www.google.com/chrome">
                            <img src="img/browsers/chrome.png" alt="">
                        </a>

                        <a href="https://www.mozilla.org/en-US/firefox/new">
                            <img src="img/browsers/firefox.png" alt="">
                        </a>

                        <a href="http://www.opera.com">
                            <img src="img/browsers/opera.png" alt="">
                        </a>

                        <a href="https://support.apple.com/downloads/safari">
                            <img src="img/browsers/safari.png" alt="">
                        </a>

                        <a href="https://www.microsoft.com/en-us/windows/microsoft-edge">
                            <img src="img/browsers/edge.png" alt="">
                        </a>

                        <a href="http://windows.microsoft.com/en-us/internet-explorer/download-ie">
                            <img src="img/browsers/ie.png" alt="">
                        </a>
                    </div>
                    <p>Sorry for the inconvenience!</p>
                </div>
            <![endif]-->

        <!-- Javascript -->
        <!-- Vendors -->
        <script src="/static/vendors/bower_components/jquery/dist/jquery.min.js"></script>
        <script src="/static/vendors/bower_components/popper.js/dist/umd/popper.min.js"></script>
        <script src="/static/vendors/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
        <script src="/static/vendors/bower_components/jquery.scrollbar/jquery.scrollbar.min.js"></script>
        <script src="/static/vendors/bower_components/jquery-scrollLock/jquery-scrollLock.min.js"></script>

     

        <!-- App functions and actions -->
<script>
    // Get the navigation trigger and sidebar elements
    const navTrigger = document.querySelector('.navigation-trigger');
    const sidebar = document.querySelector('.sidebar');

    // Add click event listener to the navigation trigger
    navTrigger.addEventListener('click', function(event) {
        event.stopPropagation(); // Stop the event from propagating to the document
        sidebar.classList.toggle('toggled'); // Toggle the 'toggled' class on the sidebar
    });

    // Add click event listener to the document to close the sidebar when clicking outside
    document.addEventListener('click', function(event) {
        const isClickInsideSidebar = sidebar.contains(event.target);
        const isClickOnNavTrigger = navTrigger.contains(event.target);

        // If the click is outside the sidebar and not on the nav trigger, close the sidebar
        if (!isClickInsideSidebar && !isClickOnNavTrigger) {
            sidebar.classList.remove('toggled');
        }
    });
</script>
        <script src="/static/js/app.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    
    function formatNotificationDate(dateString) {
        try {
            const date = new Date(dateString);
            if (isNaN(date.getTime())) {
                return { time: '', date: '' };
            }
            
            const now = new Date();
            const diffInHours = Math.abs(now - date) / 36e5;
            
            // Show relative time for recent notifications
            if (diffInHours < 24) {
                if (diffInHours < 1) {
                    const mins = Math.floor(diffInHours * 60);
                    return { time: `${mins}m ago`, date: '' };
                }
                return { time: `${Math.floor(diffInHours)}h ago`, date: '' };
            }
            
            return {
                time: date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                date: date.toLocaleDateString()
            };
        } catch (e) {
            return { time: '', date: '' };
        }
    }

    function enhanceNotificationText(content) {
        // Highlight usernames
        content = content.replace(/@(\w+)/g, '<span class="mention">@$1</span>');
        
        // Highlight action words
        const actions = ['replied', 'mentioned', 'liked', 'shared'];
        actions.forEach(action => {
            content = content.replace(new RegExp(action, 'gi'), 
                `<span class="action">${action}</span>`);
        });
        
        return content;
    }

    // Audio context variables (add at the top of your script)
let audioContext;
let notificationSoundBuffer;
let audioAllowed = false;

// Initialize audio on first user interaction
function initAudio() {
    if (audioContext) return;
    
    try {
        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        loadNotificationSound();
        document.removeEventListener('click', initAudio);
    } catch (e) {
        console.error("Audio initialization failed:", e);
    }
}

// Load the sound file
function loadNotificationSound() {
    fetch('{{ url_for("static", filename="sounds/notification.mp3") }}')
        .then(response => response.arrayBuffer())
        .then(arrayBuffer => audioContext.decodeAudioData(arrayBuffer))
        .then(buffer => {
            notificationSoundBuffer = buffer;
            audioAllowed = true;
        })
        .catch(e => console.error("Sound loading failed:", e));
}

// Play sound function
function playNotificationSound() {
    if (!audioAllowed || localStorage.getItem('notificationsMuted') === 'true') return;
    
    try {
        const source = audioContext.createBufferSource();
        source.buffer = notificationSoundBuffer;
        source.connect(audioContext.destination);
        source.start(0);
    } catch (e) {
        console.error("Error playing sound:", e);
    }
}

// Set up initial audio interaction
document.addEventListener('click', initAudio, { once: true });
    
function updateNotificationBadge() {
    fetch('/notifications/count')
        .then(response => response.json())
        .then(data => {
            const notificationIcon = document.querySelector('.top-nav__notifications a');
            const badge = notificationIcon.querySelector('.badge');
            const currentCount = badge ? parseInt(badge.textContent) : 0;
            
            if (data.count > 0) {
                if (!badge) {
                    const newBadge = document.createElement('span');
                    newBadge.className = 'badge badge-pill pulse';
                    newBadge.textContent = data.count;
                    notificationIcon.appendChild(newBadge);
                    notificationIcon.classList.add('has-notifications');
                    
                    // Play sound if audio is ready and count increased
                    if (audioAllowed && data.count > currentCount) {
                        playNotificationSound();
                    }
                } else {
                    if (data.count > currentCount && audioAllowed) {
                        playNotificationSound();
                    }
                    badge.textContent = data.count;
                }
            } else if (badge) {
                badge.remove();
                notificationIcon.classList.remove('has-notifications');
            }
        })
        .catch(console.error);
}
    document.querySelector('.top-nav__notifications a').addEventListener('click', function(e) {
        e.preventDefault();
        fetch('/notifications')
            .then(response => response.json())
            .then(data => {
                const dropdown = document.querySelector('.top-nav__notifications .dropdown-menu');
                
                let notificationsHtml;
                if (data.notifications.length > 0) {
                    notificationsHtml = data.notifications.slice(0, 5).map(n => {
                        const formattedDate = formatNotificationDate(n.created_at);
                        const enhancedContent = enhanceNotificationText(n.content);
                        
                        return `
                        <a href="/forum/thread/${n.thread_id}#post-${n.post_id}" class="listview__item ${n.is_read ? '' : 'unread'}">
                            <div class="notification-avatar">
                                <i class="zmdi zmdi-account-circle"></i>
                            </div>
                            <div class="listview__content">
                                <div class="notification-text">
                                    ${enhancedContent}
                                </div>
                                <div class="notification-meta">
                                    ${formattedDate.time ? `<span class="time">${formattedDate.time}</span>` : ''}
                                    ${formattedDate.date ? `<span class="date">${formattedDate.date}</span>` : ''}
                                </div>
                            </div>
                            ${n.is_read ? '' : '<span class="unread-dot"></span>'}
                        </a>`;
                    }).join('');
                } else {
                    notificationsHtml = `
                    <div class="empty-notification">
                        <i class="zmdi zmdi-notifications-off"></i>
                        <p>No new notifications</p>
                    </div>`;
                }

                dropdown.innerHTML = `
                    <div class="dropdown-header">
                        <span>Your Notifications</span>
                        <div class="actions">
                            <a href="#" class="actions__item zmdi zmdi-check-all" id="markAllRead" title="Mark all as read"></a>
                        </div>
                    </div>
                    <div class="listview listview--hover" id="notificationList">
                        ${notificationsHtml}
                    </div>
                    <a href="{{ url_for('view_notifications') }}" class="view-more">
                        <i class="zmdi zmdi-format-list-bulleted"></i> View All Notifications
                    </a>
                `;
                
                document.getElementById('markAllRead')?.addEventListener('click', function(e) {
                    e.preventDefault();
                    fetch('/notifications/mark_all_read', { method: 'POST' })
                        .then(() => {
                            document.querySelectorAll('.listview__item.unread').forEach(item => {
                                item.classList.remove('unread');
                            });
                            updateNotificationBadge();
                        })
                        .catch(console.error);
                });
                
                updateNotificationBadge();
            })
            .catch(console.error);
    });

    // Update every 30 seconds
    setInterval(updateNotificationBadge, 5000);
    updateNotificationBadge();
});
</script>

 {% block script %}

            {% endblock %}

    </body>

<!--Designed By ALpha-->
</html>
